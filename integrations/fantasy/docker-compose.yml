version: "3.8"

services:
  scrollr-fantasy-api:
    build:
      context: ./api
      dockerfile: Dockerfile
    container_name: scrollr-fantasy-api
    ports:
      - "8084:8084"
    environment:
      - DATABASE_URL={{ environment.DATABASE_URL }}
      - REDIS_URL={{ environment.REDIS_URL }}
      - ENCRYPTION_KEY={{ environment.ENCRYPTION_KEY }}
      - ALLOWED_ORIGINS={{ environment.ALLOWED_ORIGINS }}
      - INTEGRATION_URL={{ environment.INTEGRATION_URL }}
      - COOLIFY_FQDN={{ environment.COOLIFY_FQDN }}
      - YAHOO_CLIENT_ID={{ environment.YAHOO_CLIENT_ID }}
      - YAHOO_CLIENT_SECRET={{ environment.YAHOO_CLIENT_SECRET }}
      - FRONTEND_URL={{ environment.FRONTEND_URL }}
      - INTERNAL_YAHOO_URL=http://scrollr-fantasy-service:3003
    restart: unless-stopped

  scrollr-fantasy-service:
    build:
      context: ./service
      dockerfile: Dockerfile
    container_name: scrollr-fantasy-service
    ports:
      - "3003:3003"
    environment:
      - DATABASE_URL={{ environment.DATABASE_URL }}
      - REDIS_URL={{ environment.REDIS_URL }}
      - ENCRYPTION_KEY={{ environment.ENCRYPTION_KEY }}
      - YAHOO_CLIENT_ID={{ environment.YAHOO_CLIENT_ID }}
      - YAHOO_CLIENT_SECRET={{ environment.YAHOO_CLIENT_SECRET }}
      - SYNC_INTERVAL_SECS={{ environment.SYNC_INTERVAL_SECS }}
    restart: unless-stopped
